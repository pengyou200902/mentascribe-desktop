# Technology Stack

**Analysis Date:** 2026-02-20

## Languages

**Primary:**
- Rust (2021 edition) - Backend/Tauri application core, audio processing, speech-to-text
- TypeScript 5.4 - React frontend, type-safe UI and state management
- JavaScript (ES2020+) - Build configuration (Vite, Tailwind, PostCSS)

**Secondary:**
- Objective-C (via cocoa FFI) - macOS-specific window management and APIs
- HTML5 - Application shell and layout

## Runtime

**Environment:**
- Node.js 20.x+ (frontend development and build)
- Rust 1.75+ (backend compilation via rustup)
- Tauri 2.x runtime (embedded WebKit/WebView2 on platforms)

**Package Managers:**
- pnpm 8.x+ (Node.js dependencies - monorepo-friendly, strict peer deps)
  - Lockfile: `package-lock.json` (npm-style, generated by pnpm)
- Cargo (Rust package manager)
  - Lockfile: `src-tauri/Cargo.lock` (explicit, committed)

## Frameworks

**Core:**
- Tauri 2.x - Cross-platform desktop framework (Rust backend + WebView frontend)
  - Features enabled: `tray-icon`, `macos-private-api` (for NSPanel overlay support)
- React 18.3 - Frontend UI library
- TypeScript 5.4 - Type safety for frontend code

**UI & Styling:**
- Tailwind CSS 3.4 - Utility-first CSS framework with custom color palette
- Vite 5.2 - Frontend build tool and dev server (port 1420)
- PostCSS 8.4 - CSS transformation pipeline (Tailwind + Autoprefixer)

**State Management:**
- Zustand 4.5 - Lightweight React state management store (`src/lib/store.ts`)

**Audio & Speech:**
- whisper-rs 0.15 - Rust FFI bindings to Whisper.cpp for local speech-to-text
  - Features: `coreml` (Apple Neural Engine), `metal` (GPU acceleration on macOS)
- cpal 0.15 - Cross-platform audio capture and playback
- hound 3.5 - WAV file I/O for audio processing
- rubato 0.16 - Audio resampling for format conversion

**Platform-Specific:**
- tauri-nspanel (from git: ahkohd/tauri-nspanel v2 branch) - Convert Tauri windows to NSPanel for fullscreen overlay on macOS
- cocoa 0.25 - macOS Cocoa framework bindings
- core-graphics 0.23 - macOS graphics and display APIs
- objc 0.2 - Objective-C runtime FFI
- Windows crate 0.54 - Windows API bindings (Win32_UI_Input_KeyboardAndMouse)
- x11 2.21 - X11 display server bindings for Linux

## Key Dependencies

**Critical:**
- reqwest 0.11 - Async HTTP client for API calls (with JSON support)
- serde/serde_json 1.x - JSON serialization/deserialization with type safety
- tokio 1.x - Async runtime (full features enabled)
- thiserror 1.x - Ergonomic error handling with Display derivation
- anyhow 1.x - Flexible error handling for fallible operations

**System Integration:**
- enigo 0.2 - Cross-platform keyboard/mouse input simulation for text injection
- arboard 3.x - Cross-platform clipboard access (read/write text)
- keyring 2.x - OS keychain/credential storage (secure token storage)
- global-hotkey 0.5 - Cross-platform global hotkey registration
- tauri-plugin-global-shortcut 2.x - Tauri integration for global shortcuts

**Filesystem & Config:**
- dirs 6.0 - Standard platform-specific paths (config, cache, home)
- tauri-plugin-fs 2.x - Tauri file system plugin for secure file access
- tauri-plugin-shell 2.x - Tauri shell command execution

**Utilities:**
- chrono 0.4 - Date/time handling with serde support
- uuid 1.x - Unique identifier generation (v4 with serde)
- regex 1.x - Pattern matching for text processing
- lazy_static 1.5 - Lazy static initialization
- once_cell 1.19 - Single-assignment cells for one-time initialization
- log 0.4 - Logging facade
- env_logger 0.11 - Environment-based logger implementation

**Development:**
- @tauri-apps/cli 2.x - Tauri CLI for development/build
- @tauri-apps/api 2.x - Tauri JavaScript/TypeScript API bindings
- React DevTools compatible (via Vite + React Fast Refresh)
- ESLint 8.57 with TypeScript support (@typescript-eslint/parser 7.x)
- Prettier 3.2 - Code formatter
- Vitejs/plugin-react 4.2 - React Fast Refresh integration
- Autoprefixer 10.4 - CSS vendor prefix automation

## Configuration

**Environment:**
- Development: `tauri.conf.json` specifies dev URL (`http://localhost:1420`) and frontend dist path
- Production: CSP (Content Security Policy) configured in `tauri.conf.json` - restricts connect-src to `https://api.voice.mentaflux.ai`, images from self/https, styles from self + unsafe-inline
- TypeScript strict mode enabled: `strict: true`, `noUnusedLocals`, `noUnusedParameters`, `noFallthroughCasesInSwitch`

**Build:**
- Frontend: Vite config in `vite.config.ts` - targets ES2021, Chrome 100, Safari 13
- Backend: Cargo.toml with release optimizations: `panic = "abort"`, `lto = true`, `codegen-units = 1`, `opt-level = 3`, `strip = true`
- Custom build script: `src-tauri/build.rs` (for Tauri build setup)

**Linting & Formatting:**
- ESLint rules: React, React Hooks, TypeScript
- Prettier config: default (single quotes, 80-char line length for ESLint config)
- Cargo clippy: standard Rust linting
- `cargo fmt`: Rust code formatting (2-space indent)

## Platform Requirements

**Development:**
- macOS: Xcode Command Line Tools (`xcode-select --install`)
- Windows: Visual Studio Build Tools (C++ workload), WebView2
- Linux: libwebkit2gtk-4.1-dev, build-essential, curl, wget, libssl-dev, libayatana-appindicator3-dev, librsvg2-dev, libasound2-dev

**Deployment:**
- macOS: 10.15+ (Big Sur+) - builds to `.dmg` via tauri-bundle
- Windows: Windows 10+ - builds to `.msi` via NSIS installer
- Linux: glibc-based systems - builds to `.AppImage`, `.deb`, `.rpm`

**System Permissions (Runtime):**
- macOS: Microphone (system prompt), Accessibility (manual grant in System Preferences)
- Windows: Microphone (Windows privacy settings)
- Linux: PulseAudio/ALSA audio access

## External Service Endpoints

**API:**
- Base: `https://api.voice.mentaflux.ai/v1` (defined in `src-tauri/src/api/client.rs`)
  - `/auth/login` - POST (email/password)
  - `/auth/refresh` - POST (refresh token)
  - `/transcriptions` - POST (create transcription record)

**Model Downloads:**
- HuggingFace: `https://huggingface.co/ggerganov/whisper.cpp/resolve/main` (base URL for Whisper GGML models)
- Distil Whisper: `https://huggingface.co/distil-whisper/distil-large-v3.5-ggml/resolve/main` (alternative model source)

---

*Stack analysis: 2026-02-20*
